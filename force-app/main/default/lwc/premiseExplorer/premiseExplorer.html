<template>
    <template if:false={isDetail}>
        <lightning-layout title="Product Explorer" multiple-rows="true" class="slds-card">
            <lightning-layout-item size="12" style="background-color: #000066;">
                <div class="slds-text-title" style="font-size: 25px; font-weight: bold; margin-left: 45%; width: 40%; margin-top: 1%; margin-bottom: 1%; color: white;">Find Property</div>
            </lightning-layout-item>
            <!-- search -->
            <lightning-layout-item size="12" style="background-color: #000066;">
                <div style="margin-left: 30%; width: 40%;">           
                    <lightning-layout horizontal-align="middle" multiple-rows="true">
                        <lightning-layout-item size="12">
                            <lightning-input style="-webkit-text-fill-color:white;" type="text" label="Product Name" value={productName} onchange={handleProductNameChange}></lightning-input>
                        </lightning-layout-item>
                        <lightning-layout-item size="12">
                            <lightning-input style="-webkit-text-fill-color:white;" type="text" label="Product City" value={productCity} onchange={handleProductCityChange}></lightning-input>
                        </lightning-layout-item>
                        <template if:true={showFilter}>
                            <lightning-layout style="width: 100%;" multiple-rows="true">
                                <lightning-layout-item size="12">
                                    <lightning-slider style="-webkit-text-fill-color:white;" label="Max Price (EUR)" value={maxPrice} step="0.01" min="0" max="200000" onchange={handleMaxPriceChange}></lightning-slider>
                                </lightning-layout-item>
                                <lightning-layout-item size="12">
                                    <lightning-slider style="-webkit-text-fill-color:white;" label="Min Size (m2)" value={minSize} step="0.01" min="0" max="100" onchange={handleSizeChange}></lightning-slider>
                                </lightning-layout-item>
                                <lightning-layout-item size="12">
                                    <lightning-layout>
                                        <lightning-layout-item size="3">
                                            <lightning-input id="checkbox-wifi" style="-webkit-text-fill-color:white;" type="checkbox" name="wifi" label="Wi-Fi" value={wifi} onchange={handleWifiChange}></lightning-input>
                                        </lightning-layout-item>
                                        <lightning-layout-item size="3">
                                            <lightning-input id="checkbox-parking" style="-webkit-text-fill-color:white;" type="checkbox" name="parking" label="Parking" value={parking} onchange={handleParkingChange}></lightning-input>
                                        </lightning-layout-item>
                                        <lightning-layout-item size="3">
                                            <lightning-input id="checkbox-elevator" style="-webkit-text-fill-color:white;" type="checkbox" name="elevator" label="Elevator" value={elevator} onchange={handleElevatorChange}></lightning-input>
                                        </lightning-layout-item>
                                        <lightning-layout-item size="3">
                                            <lightning-input id="checkbox-kitchen" style="-webkit-text-fill-color:white;" type="checkbox" name="kitchen" label="Kitchen" value={kitchen} onchange={handleKitchenChange}></lightning-input>
                                        </lightning-layout-item>
                                    </lightning-layout>
                                </lightning-layout-item>
                            </lightning-layout>
                        </template>
                    </lightning-layout>
                    <div class="slds-var-m-vertical_medium">
                        <template if:true={showFilter}>
                            <lightning-button icon-name="utility:filterList" icon-position="right" variant="neutral" label="Hide Filter" onclick={hideFilter} class="search-button filter-button" style="margin-right: 5px;"></lightning-button>
                        </template>
                        <template if:false={showFilter}>
                            <lightning-button icon-name="utility:filterList" icon-position="right" variant="neutral" label="Filter" onclick={displayFilter} class="search-button filter-button" style="margin-right: 5px;"></lightning-button>
                        </template>
                        <lightning-button variant="neutral" label="Clear Filter" onclick={clearFilter} class="search-button filter-button" style="margin-right: 5px;"></lightning-button>
                        <lightning-button variant="neutral" label="Recently Viewed" onclick={showRecentlyViewed} class="search-button filter-button" style="margin-right: 5px;"></lightning-button>
                        <!-- <lightning-button icon-name="utility:search" icon-position="right" variant="brand" label="Search" onclick={getProducts} class="search-button"></lightning-button> -->
                    </div>
                </div>               
            </lightning-layout-item>

            <!-- spinner -->
            <template if:true={loading}>
                <lightning-spinner variant="brand" alternative-text="Loading..." size="medium"></lightning-spinner>
            </template>

            <!-- results -->
            <template if:false={isLastSeen}>
                <lightning-layout-item size="12" style="margin-left: 1%; width: 99%;">
                    <template if:true={noProducts}>
                        <h2>No products found</h2>
                    </template>
                    <template if:true={productsDisplayed}>
                        <!-- <div class="slds-text-title" style="font-size: 15px; font-weight: bold; margin-top: 1%; margin-bottom: 1%;">Results</div> -->
                        <div class="slds-scrollable_y">
                            <lightning-layout horizontal-align="center" multiple-rows>
                                <template for:each={products} for:item="product">
                                    <lightning-layout-item key={product.Id} padding="around-small" size="2">
                                        <c-product-tile product={product} onproductselect={selectProduct} selected-product-id={selectedProductId}></c-product-tile>
                                    </lightning-layout-item>
                                </template>
                            </lightning-layout>
                        </div>
                    </template>
                </lightning-layout-item>
            </template>
            <template if:true={isLastSeen}>
                <lightning-layout-item size="12" style="margin: 1%; width: 98%;">
                    <template if:false={lastproducts}>
                        <h2>No products found</h2>
                    </template>
                    <template if:true={lastproducts}>
                        <!-- <div class="slds-text-title" style="font-size: 15px; font-weight: bold; margin-top: 1%; margin-bottom: 1%;">Results</div> -->
                        <div class="slds-scrollable_y">
                            <lightning-layout multiple-rows="true">
                                <template for:each={lastproducts} for:item="lastproduct">
                                    <lightning-layout-item key={lastproduct.id} size="12">
                                        <div onclick={selectLastProduct} data-product-id={lastproduct.id} class="container" style="border: lightgrey solid 1px; padding: 1%; border-radius: 3px;">{lastproduct.name}</div>
                                        <!-- <c-product-tile product={product} onproductselect={selectProduct} selected-product-id={selectedProductId}></c-product-tile> -->
                                    </lightning-layout-item>
                                </template>
                            </lightning-layout>
                        </div>
                    </template>
                </lightning-layout-item>
            </template>

            <!-- pagination -->
            <template if:false={isLastSeen}>
                <lightning-layout-item size="12" style="margin-left: 35%; width: 31%;">
                    <div class="slds-var-m-vertical_medium">
                        <template if:true={productsDisplayed}>
                            <lightning-layout>
                                <lightning-layout-item>
                                    <lightning-button label="First" 
                                        icon-name="utility:arrow_left"
                                        onclick={handleFirst}
                                        disabled={isPrev}
                                        style="margin-right: 5px;"><a href="#page1"></a></lightning-button>
                                </lightning-layout-item>
                                <lightning-layout-item>
                                    <lightning-button label="Previous" 
                                        icon-name="utility:chevronleft"
                                        onclick={handlePrevious}
                                        disabled={isPrev}><a href="#page1"></a></lightning-button>
                                </lightning-layout-item>
                                <lightning-layout-item flexibility="grow">
                                    <p class="slds-text-align_center">Page {pageNumber} of {totalPages}</p>
                                </lightning-layout-item>
                                <lightning-layout-item>
                                    <lightning-button label="Next" 
                                        icon-name="utility:chevronright"
                                        icon-position="right"
                                        onclick={handleNext}
                                        disabled={isNext}><a href="#page1"></a></lightning-button>
                                </lightning-layout-item>
                                <lightning-layout-item>
                                    <lightning-button label="Last" 
                                        icon-name="utility:arrow_right"
                                        icon-position="right"
                                        onclick={handleLast}
                                        disabled={isNext}
                                        style="margin-left: 5px;"><a href="#page1"></a></lightning-button>
                                </lightning-layout-item>
                            </lightning-layout>
                        </template>
                    </div>
                </lightning-layout-item>
            </template>
        </lightning-layout>
    </template>
    <template if:true={isDetail}>
        <c-product-details product-id={selectedProductId}></c-product-details>
    </template>
</template>
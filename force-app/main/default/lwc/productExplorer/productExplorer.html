<template>
    <lightning-layout title="Product Explorer" multiple-rows="true" class="slds-card">
        <lightning-layout-item size="12" style="background-color: #83b0f7;">
            <div class="slds-text-title" style="font-size: 25px; font-weight: bold; margin-left: 43%; width: 40%; margin-top: 1%; margin-bottom: 1%;">Property Explorer</div>
        </lightning-layout-item>
        <!-- search -->
        <lightning-layout-item size="12" style="background-color: #83b0f7;">
            <div style="margin-left: 30%; width: 40%;">           
                <template if:true={isApartments}>
                    <lightning-layout horizontal-align="middle" multiple-rows="true">
                        <lightning-layout-item size="12">
                            <lightning-input type="text" label="Product Name" value={productName} onchange={handleProductNameChange}></lightning-input>
                        </lightning-layout-item>
                        <lightning-layout-item size="12">
                            <lightning-input type="text" label="Product City" value={productCity} onchange={handleProductCityChange}></lightning-input>
                        </lightning-layout-item>
                        <lightning-layout-item size="12">
                            <lightning-combobox
                                name="apartment_type"
                                label="Apartment Type"
                                value={apartmentType}
                                options={apartmentTypes}
                                onchange={handleApartmentTypeChange}></lightning-combobox>
                        </lightning-layout-item>
                        <lightning-layout-item size="4">
                            <lightning-input type="checkbox" name="laundry" label="Laundry" value={laundry} onchange={handleLaundryChange}></lightning-input>
                        </lightning-layout-item>
                        <lightning-layout-item size="4">
                            <lightning-input type="checkbox" name="balcony" label="Balcony" value={balcony} onchange={handleBalconyChange}></lightning-input>
                        </lightning-layout-item>
                        <lightning-layout-item size="4">
                            <lightning-input type="checkbox" name="livingRoomKitchen" label="Living Room with the Kitchen" value={livingRoomKitchen} onchange={handleLivingRoomKitchenChange}></lightning-input>
                        </lightning-layout-item>
                    </lightning-layout> 
                </template>
                <template if:false={isApartments}>
                    <lightning-layout horizontal-align="middle" multiple-rows="true">
                        <lightning-layout-item size="12">
                            <lightning-input type="text" label="Product Name" value={productName} onchange={handleProductNameChange}></lightning-input>
                        </lightning-layout-item>
                        <lightning-layout-item size="12">
                            <lightning-input type="text" label="Product City" value={productCity} onchange={handleProductCityChange}></lightning-input>
                        </lightning-layout-item>
                        <template if:true={showFilter}>
                            <lightning-layout style="width: 100%;" multiple-rows="true">
                                <lightning-layout-item size="12">
                                    <lightning-slider label="Max Price (EUR)" value={maxPrice} step="0.01" min="0" max="200000" onchange={handleMaxPriceChange}></lightning-slider>
                                </lightning-layout-item>
                                <lightning-layout-item size="12">
                                    <lightning-slider label="Min Size (m2)" value={minSize} step="0.01" min="0" max="100" onchange={handleSizeChange}></lightning-slider>
                                </lightning-layout-item>
                                <lightning-layout-item size="12">
                                    <lightning-layout>
                                        <lightning-layout-item size="3">
                                            <lightning-input type="checkbox" name="wifi" label="Wi-Fi" value={wifi} onchange={handleWifiChange}></lightning-input>
                                        </lightning-layout-item>
                                        <lightning-layout-item size="3">
                                            <lightning-input type="checkbox" name="parking" label="Parking" value={parking} onchange={handleParkingChange}></lightning-input>
                                        </lightning-layout-item>
                                        <lightning-layout-item size="3">
                                            <lightning-input type="checkbox" name="elevator" label="Elevator" value={elevator} onchange={handleElevatorChange}></lightning-input>
                                        </lightning-layout-item>
                                        <lightning-layout-item size="3">
                                            <lightning-input type="checkbox" name="kitchen" label="Kitchen" value={kitchen} onchange={handleKitchenChange}></lightning-input>
                                        </lightning-layout-item>
                                    </lightning-layout>
                                </lightning-layout-item>
                            </lightning-layout>
                        </template>
                    </lightning-layout>
                </template>
                <div class="slds-var-m-vertical_medium">
                    <template if:true={showFilter}>
                        <lightning-button variant="neutral" label="Hide Filter" onclick={hideFilter} class="search-button" style="margin-right: 5px;"></lightning-button>
                    </template>
                    <template if:false={showFilter}>
                        <lightning-button variant="neutral" label="Filter" onclick={displayFilter} class="search-button" style="margin-right: 5px;"></lightning-button>
                    </template>
                    <lightning-button variant="brand" label="Search" onclick={getProducts} class="search-button"></lightning-button>
                </div>
            </div>               
        </lightning-layout-item>

        <!-- spinner -->
        <template if:true={loading}>
            <lightning-spinner variant="brand" alternative-text="Loading..." size="medium"></lightning-spinner>
        </template>

        <!-- results -->
        <lightning-layout-item size="12" style="margin-left: 1%; width: 99%;">
            <template if:true={noProducts}>
                <h2>No products found</h2>
            </template>
            <template if:true={productsDisplayed}>
                <!-- <div class="slds-text-title" style="font-size: 15px; font-weight: bold; margin-top: 1%; margin-bottom: 1%;">Results</div> -->
                <div class="slds-scrollable_y">
                    <lightning-layout horizontal-align="center" multiple-rows>
                        <template for:each={products} for:item="product">
                            <lightning-layout-item key={product.Id} padding="around-small" size="2">
                                <c-product-tile product={product} onproductselect={selectProduct} selected-product-id={selectedProductId}></c-product-tile>
                            </lightning-layout-item>
                        </template>
                    </lightning-layout>
                </div>
            </template>
        </lightning-layout-item>

        <!-- pagination -->
        <lightning-layout-item size="12" style="margin-left: 35%; width: 31%;">
            <div class="slds-var-m-vertical_medium">
                <template if:true={productsDisplayed}>
                    <lightning-layout>
                        <lightning-layout-item>
                            <lightning-button label="First" 
                                icon-name="utility:arrow_left"
                                onclick={handleFirst}
                                disabled={isPrev}><a href="#page1"></a></lightning-button>
                        </lightning-layout-item>
                        <lightning-layout-item>
                            <lightning-button label="Previous" 
                                icon-name="utility:chevronleft"
                                onclick={handlePrevious}
                                disabled={isPrev}><a href="#page1"></a></lightning-button>
                        </lightning-layout-item>
                        <lightning-layout-item flexibility="grow">
                            <p class="slds-text-align_center">Page {pageNumber} of {totalPages}</p>
                        </lightning-layout-item>
                        <lightning-layout-item>
                            <lightning-button label="Next" 
                                icon-name="utility:chevronright"
                                icon-position="right"
                                onclick={handleNext}
                                disabled={isNext}><a href="#page1"></a></lightning-button>
                        </lightning-layout-item>
                        <lightning-layout-item>
                            <lightning-button label="Last" 
                                icon-name="utility:arrow_right"
                                icon-position="right"
                                onclick={handleLast}
                                disabled={isNext}><a href="#page1"></a></lightning-button>
                        </lightning-layout-item>
                    </lightning-layout>
                </template>
            </div>
        </lightning-layout-item>
    </lightning-layout>
</template>